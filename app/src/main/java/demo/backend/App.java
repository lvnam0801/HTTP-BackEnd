/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package demo.backend;

import demo.backend.library.httpserver.HttpServer;
import demo.backend.model.UserModel;

public class App {
    public String getGreeting() {
        return "Starting...";
    }

    public static void main(String[] args) {
        System.out.println(new App().getGreeting());

        /**
         * Http methods: 
         * GET, POST, PUT, DELETE: read, create, update, delete (CURL)
         */
        // HttpServer.get("/read", new Router() {
        //     @Override
        //     public HttpResponse handle(Request req, Response res) throws Exception {
        //         Integer userId = Integer.parseInt(req.queryParams("userId"));
        //         return UserModel.getInst().read(userId);
        //     }
        // });

        HttpServer.get("/read", (req, res) -> {
            Integer userId = Integer.parseInt(req.queryParams("userId"));
            return UserModel.getInst().read(userId);
        });

        HttpServer.post("/create", (req, res) -> {
            Integer userId = Integer.parseInt(req.queryParams("userId"));
            String name = req.queryParams("name");
            Integer age = Integer.parseInt(req.queryParams("age"));
            return UserModel.getInst().create(userId, name, age);
        });

        HttpServer.put("/update", (req, res) -> {
            Integer userId = Integer.parseInt(req.queryParams("userId"));
            String name = req.queryParams("name");
            Integer age = Integer.parseInt(req.queryParams("age"));
            return UserModel.getInst().update(userId, name, age);
        });
        
        HttpServer.delete("/delete", (req, res) -> {
            Integer userId = Integer.parseInt(req.queryParams("userId"));
            return UserModel.getInst().delete(userId); 
        });
    }
}
